{% extends 'base.html' %}
{% load static %}
{% load cart_tags %}
{% block menu %}
{% endblock %}
{% block body_tag %}onunload="window.opener.location.reload(){% endblock %}
{#{% block jumbotron %}<h2 class="page-header">{{ object.block_num }}</h2><br>#}
{#    {% for item in slab_list %}#}
{#        {{ item.thickness }}#}
{#        厚度/{{ item.part_count }}#}
{#        夹/ {{ item.block_pics }}#}
{#        件/ {{ item.quantity }}#}
{#        m2#}
{#    {% endfor %}#}
{#{% endblock %}#}

{% block main %}
    <div style="height:60px"></div>
    <form method="post" id="slab_form" action="{% url 'cart:add' %}">
        {% for item in slab_list %}

            <ul class="nav nav-tabs">
                {% for part_key ,part_value in item.part_num.items %}
                    <li {% if forloop.first %} class="active" {% endif %}><a
                            {% if forloop.first %}aria-expanded="true"{% endif %}
                            data-toggle="tab"
                            href="#{{ item.thickness|slugify }}{{ part_key }}">
                        {{ part_key }}#夹</a>
                    </li>
                {% endfor %}
            </ul>

        {% endfor %}
        <div class="tab-content">
            {% for block in slab_list %}
                    <div role="tabpanel" class="tab-pane {% if forloop.first %} active{% endif %}"
                         id="{{ slabs.thickness|slugify }}{{ part_key }}">
                    <div class="panel panel-default">
                    <div class="panel-heading">
                        <div class="panel-body">
                            <input type="checkbox" name="check_box_list"
                                   value="{{ block.block_num }}">
                            {{ block.thickness }}/{{ block.quantity }}{{ block.unit }}
                        </div>
                    </div>
                {% endfor %}

        </div>
        <div style="height:20px "></div>
        <input type="hidden" name="path" value="{{ request.path }}">
        <input type="hidden" name="block_num" value="{{ object.block_num }}">
        <input type="hidden" name="thickness" value="{{ object.thickness }}">
        <input type="hidden" name="key" value="current_order">
        <input type="hidden" name="block"
               value="{% ifequal object.block_type 'otw' %}1{% else %}0{% endifequal %}">
        {% csrf_token %}
    </form>
    <div class="navbar navbar-fixed-top" style="background-color: #f5f5f5">
        <ul class="list-unstyled">
            <li><input class="btn btn-primary btn-block" type="submit"
                       value="添加选择到项目" form="slab_form"></li>
            <li  style="padding-left: 20px">
                <ul class="list-unstyled">
                    <li><h3>{{ object.block_num }}</h3>
                    </li>
                    <li>
                        <ul class="list-inline">
                            {% for item in slab_list %}

                                <li>{{ item.thickness }}
                                    厚度
                                </li>
                                <li>{{ item.part_count }}
                                    夹
                                </li>
                                <li>{{ item.block_pics }}
                                    件
                                </li>
                                <li>{{ item.quantity }}m2
                                </li>
                                <li>
                                    <input type="checkbox"
                                           id="{{ item.thickness|slugify }}{{ part_key }}_all"
                                           onclick="select_all(this.id, this.checked)">全选/不选
                                </li>
                            {% endfor %}

                        </ul>

                    <li>
                        <ul class="list-inline" id="selected_info">
                            <li name="pics">目前已勾选:<b>pics</b>件</li>
                            <li name="m2"><b>m2</b>m2</li>
                        </ul>
                    </li>
                    </li>
                </ul>
            </li>

        </ul>
    </div>
    <script src="{% static "js/myJS.js" %}"></script>
{% endblock %}
{% block domready %}
    sum_m2()
{% endblock %}

